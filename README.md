# mrstreths_dbmng

Для отправки и проверки работ dbmng

## Струтура

- requirements.txt \- все необходимые зависимости, чтобы все работало. Необходимо установить.
- execute\_sql\_query.py \- скрипт для выполнения SQL запросов из текстового файла (.txt)
- main.py \- основной скрипт для работы
- test\_<lab...>.py \- тесты к написанным лабораторным работам
- tests \- дирректория, в которой содержится вспомогательные данные для тестирования для каждого варианта заданий. 
- make\_data\_sql\_test.py \- вспомогательная программа для написания тестов. Не задействуется в работе. Чисто для разработчика.

## Как все работает?
Студент отправляет файл выполненной лаб. работы

Существует два типа файлов для отправки: скрипт .py и текстовый файл .txt - где sql запрос

Файл должен иметь строго определенное имя:
  <ваши\_инициалы>\_lab1a\_<номер\_варианта>.txt
  
  Пример: gar\_lab1a\_0.txt
  
Файл для проверки должен находиться в корневой папке проекта.
Далее запускается скрипт main.py с параметрами из консоли
python3 main.py <имя файла для проверки>

Пример: python3 main.py gar\_lab1a\_0.txt

Что делает скрипт main.py:
1.	Подготавливает рабочее пространство для проверки: удаляет бд если была
2.	Создает параметризованный файл parameters.txt, где содержится имя работы, инициалы, номер лабораторной, вариант и пр
Пример содержания parameters.txt:
- WORK\_FILE\_NAME=gar\_lab1a\_1.txt
- AUTHOR=gar
- WORK=lab1a
- VARIANT=1
- DATABASE_NAME=mydatabase.db
3.	В зависимости от типа файла выполняет те или иные действия: если это sql запрос, то выполняет его, если скрипт, то также выполняет полностью или выборочно функции (не доделал, это lab_1b) 

После этого запускается тесты командой

  pytest -q <имя\_теста\_для\_проверки>
  
Так как у нас первая лабораторная работа Lab\_1a, то это файл test\_lab1a.py

Пример: pytest -q test_lab1a.py

Примечание: ключ -q это тихий режим, поставил просто так

Тест обращается к параметризованному файлу, чтобы найти файл проверки согласно варианту задания.
Все файлы для проверки варианты задания хранятся в tests/<имя\_лабораторной\_работы>/<вариант>

Пример: tests/variants\_lab1a/variant\_0.py

variant\_0.py – простой файл, где объявлены переменные: какие должны быть имена таблиц, типы столбцов и прочее
После того, как вариант задания был найден, производится тестирование

~~## Списко лабораторный работ с вариантами

labworks.docx 

~~##Как добавить вариант к работе Lab\_1~~

Допустим необходимо добавить новый вариант к работе Lab\_1a
1. Необходимо письменно добавить задание в labworks.docx, где сформулировать четкие требования. 
2. Написать "правильный" sql запрос. Сохранить его в correct\_sql\_lab1a\_<номер варианта>.py
3. Запустить make\_data\_sql\_test.py
4. В tests должен будет создаться нужные данные для теста. Все.
